import { Meta, Story, Canvas, ArgsTable } from "@storybook/addon-docs";
import { html } from "lit-html";
import field from "./f-formbuilder-field";
import { useArgs, useState } from "@storybook/client-api";
import { createRef, ref } from "lit/directives/ref.js";

<Meta
  title="Components/f-form-builder"
  parameters={{
    controls: { hideNoControlsWarning: true },
  }}
/>

# f-form-builder

<br />
<br />

## Overview

<f-divider></f-divider>

<br />

### [Playground](/story/components-f-form-builder--playground)

<Canvas>
  <Story
    name="Playground"
    argTypes={{
      field: {
        control: "object",
      },
      value: { control: "object" },
    }}
    args={{
      field,
      value: {},
    }}
  >
    {(args) => {
      const [_, updateArgs] = useArgs();
      const [state, setState] = useState({});
      const fieldRef = createRef();
      const handleSubmit = (event) => {
        console.log("Submit event", event.detail);
        window.alert("event submit successfully");
      };
      const handleInput = (event) => {
        if (fieldRef.value) {
          fieldRef.value.textContent = JSON.stringify(
            event.detail,
            undefined,
            2
          );
        }
        console.log("input event", event.detail);
      };
      const handleKeydown = (event) => {
        event.stopPropagation();
        event.stopImmediatePropagation();
      };
      return html` <f-div padding="medium" gap="medium" overflow="scroll">
        <f-form-builder
          .field=${args.field}
          .value=${args.value}
          @submit=${handleSubmit}
          @input=${handleInput}
          @keydown=${handleKeydown}
        >
          <f-div>
            <f-button label="submit" type="submit"></f-button>
          </f-div>
        </f-form-builder>
        <f-div>
          <pre ${ref(fieldRef)}>
${JSON.stringify(args.value, undefined, 8)}</pre
          >
        </f-div>
      </f-div>`;
    }}
  </Story>
</Canvas>

<br />

<ArgsTable of={"f-form-builder"} />
